<div class="wikidoc"><h1>Geckoboard Data Service</h1>This activity provides a WCF REST data service that exposes Wolfpack HealthCheck result data stored in the Wolfpack database as a native Geckoboard JSON data feed - this means you can create a new custom widget in Geckoboard to display Wolfpack data without having to convert the feed from one format to another - this data feed is formatted specifically for Geckoboard custom widgets. The service has a pluggable data provider design so that it can read the Wolfpack data from any supported Database (currently SqlServer and SQLite) and is extensible for future data stores - just implement the appropriate provider interface.<br /><img src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=wolfpack&DownloadId=257540" alt="geckoboarddataservice.png" title="geckoboarddataservice.png" /><br /><br /><a href="http://geckoboard.com/">Geckoboard</a> is a hosted &quot;dashboard&quot;, a realtime business status board. It has connectors to a wide range of data feeds such as Twitter, Google Analytics, Pingdom, Basecamp, Highrise &amp; ZenDesk to name a few and you can customise what data is display and how it is visualised - it also supports custom widgets that include <a href="http://geckoboard.zendesk.com/entries/274940-custom-chart-widget-type-definitions">pie charts, line charts, a geck-o-meter (min, max, avg)</a> and <a href="http://geckoboard.zendesk.com/entries/231507-custom-widget-type-definitions">general textual and RAG</a> style status indicators.<br /><br />How does Wolfpack integrate with Geckoboard? HealthCheck results are either boolean or numerical (or both) so can be visualized in the appropriate custom widget. Failures can be displayed as a pie chart per site and in more detail as a breakdown by failure HealthCheck type for a specific site. Any numeric based HealthCheck can be displayed as either a line chart or as a &quot;geck-o-meter&quot; - this displays a min, max and average.<br />
<h2>Supported Widgets</h2><ul><li><a href="https://wolfpack.codeplex.com/wikipage?title=Geckoboard%20Map&referringTitle=Geckoboard%20Data%20Service">Map</a> - plot HealthChecks or <a href="https://wolfpack.codeplex.com/wikipage?title=AppStats&referringTitle=Geckoboard%20Data%20Service">AppStats</a> on a Geckoboard map</li>
<li><a href="https://wolfpack.codeplex.com/wikipage?title=Geckoboard%20Piechart&referringTitle=Geckoboard%20Data%20Service">Pie Chart</a> - display HealthChecks or <a href="https://wolfpack.codeplex.com/wikipage?title=AppStats&referringTitle=Geckoboard%20Data%20Service">AppStats</a> as a pie chart</li>
<li><a href="https://wolfpack.codeplex.com/wikipage?title=Geckoboard%20Linechart&referringTitle=Geckoboard%20Data%20Service">Line Chart</a> - display HealthChecks or <a href="https://wolfpack.codeplex.com/wikipage?title=AppStats&referringTitle=Geckoboard%20Data%20Service">AppStats</a> as a line chart</li></ul>
<br /><b>NOTE: The info about the Widgets below is out of date - I am in the process of creating a page per widget (like the Map above). The urls quoted are out of date in most cases - please check the <a href="http://wolfpack.codeplex.com/SourceControl/changeset/view/45e94986edfb#Solutions%2fWolfpack.Core%2fGeckoboard%2fGeckoboardDataService.cs">source code</a> (WebInvoke attribute) for the actual REST url templates. I will try to get these pages and updated ASAP</b><br />
<h3>Line Charts</h3><ul><li><b>This url has been replaced with a new linechart url in v1.0.8 - TODO update this documentation ASAP</b></li>
<li><i>http base address</i>/geckoboard/linechart/sites/<i>siteid</i>/<i>checkid</i> - line chart displays the value of the ResultCount for the site and HealthCheck.</li>
<li>X and Y axis labels are automatically generated from the min/mid/max dates and values respectively.</li>
<li>Querystring params to control what data is displayed...
<ul><li><b>limit</b> restricts the results to the last n records</li>
<li><b>sample</b> is the frequency within the data that a record is selected for the graph.</li>
<li><b>tag</b> is a tag that <i>exactly</i> matches the <b>Tag</b> property set on a HealthCheck result</li>
<li><b>scaleup</b>, <b>scaledown</b> - these modify the value. <b>scaledown</b> will divide the value by the scale you supply and scaleup will do the reverse. </li>
<li><b>scaley</b> &quot;true&quot; or &quot;false&quot; to apply scale to the y axis labels</li>
<li><b>scaleydp</b> sets the dp on the y axis labels</li>
<li>Example: you monitor a value once a minute. You could either display the last 300 records OR to display the graph for the last 24 hours set limit=1440 (number of minutes in a day) and sample=10 to select every tenth reading. You can also omit the <b>sample</b> parameter to have Wolfpack calculate this to return the maximum number of readings possible.</li></ul></li></ul>

<h3>Geck-o-meter</h3><ul><li><i>http base address</i>/geckoboard/geckometer/sites/<i>siteid</i>/<i>checkid</i> - gecko-o-meter displaying the min, max and average of the ResultCount values for the site and HealthCheck specified.</li></ul>

<h3>Number Comparison</h3><ul><li><i>http base address</i>/geckoboard/comparison/sites/<i>siteid</i>/<i>checkid</i> - displays the last ResultCount value against the previous value for the site and HealthCheck specified.</li>
<li><i>http base address</i>/geckoboard/days/<i>yyyy-mm-dd</i> - displays the number of days between today and the date supplied. This is useful for creating countdowns to milestones/important dates.</li></ul>

<h2>Configuration</h2>Pretty simple really. All settings are found in the config\activity.castle.config file.  Remember this activity will load the data from the Wolfpack database &quot;AgentData&quot; table (SqlServer or SQLite) - you need to configure your Wolfpack agents/server to publish to either database to begin capturing data before you can display it with Geckoboard.<br />
<h3>GeckoboardDataServiceActivityConfig component</h3>This is the master configuration and is used to control the behaviour of this activity.
<ul><li>Enabled - true or false, switches the activity on or off respectively.</li>
<li>ServiceImplementation - the class WCF will create as the service implementation.</li>
<li>Uri - the endpoint to host this service.
<ul><li>Remember this must be internet addressable so ensure you set up port forwarding and firewalls to the machine that is running this Activity inside Wolfpack.</li></ul></li>
<li>ApiKey - this is the value you use in the &quot;ApiKey&quot; field of the &quot;Add a new widget&quot; in Geckoboard. Leave this blank to disable this security check.</li></ul>

<h3>GeckoboardDataServiceConfig component</h3>This is the data service configuration. It allows you to select the data provider.
<ul><li>If you publish your result data to SqlServer then you must set the &quot;DataProvider&quot; property to &quot;SqlServer&quot;</li>
<li>If you publish your result data to SQLite then you must set the &quot;DataProvider&quot; property to &quot;SQLite&quot;</li></ul>
<b>NOTE!</b> In order to cut down on configuration, neither data provider has a configuration component that is exposed in the config file. The only property it provides is the connection string and this is by default the &quot;Wolfpack&quot; connection for the SqlServer Data Provider and &quot;Wolfpack-SQLite&quot; for the SQLite provider. If you do need to change this then you would need to add to appropriate component to the config file.<br />
<h3>ColourPicker component</h3>This controls the colours displayed on geckoboard widgets. It is possible to reserve colours for specific labels so for instance you can ensure that the pie chart segment colours remain consistent. You can also nominate favourite colours - these form the preferred palette of colours to be used before any randomly generated colours. <br />
<ul><li>The &quot;Reserved&quot; property takes new dictionary items where the &quot;key&quot; attribute is the label and the value is either a hex RGB value (eg: FF0000 = Red) or a <a href="http://msdn.microsoft.com/en-us/library/system.drawing.knowncolor%28v=VS.90%29.aspx">known system colour</a> such as &quot;Red&quot;. </li>
<li>The &quot;Favourites&quot; property takes a list of items where the value is either a hex RGB value or a known system colour.</li>
<li>If no colours are reserved or made favourite (or you run out of favourites) a random colour will be assigned automatically</li></ul>

<h2>Adding a Geckoboard Widget</h2><div style="clear:both;height:0;">&nbsp;</div><img style="float:right;padding-left:.5em;" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=wolfpack&DownloadId=257539" alt="geckoboard-addwidget.png" title="geckoboard-addwidget.png" /><br />Remember Geckoboard will need a public internet addressable URL for its data feed so make sure you expose the Wolfpack REST service to the internet. At this time Geckoboard does not support any other port than 80 &lt;- Looks like this has been lifted and all ports now work (Thanks to comment below for the info). <br /><br />If you are worried about exposing this data to the world then you should add a secret API key - this should also be entered into the activity.castle.config GeckoboardDataServiceActivityConfig ApiKey configuration property to ensure that only authentic requests are served data.<br /><br />Fill in the other fields as shown on the right (set your own reload time and label though!)<br /><br /></div><div class="ClearBoth"></div>